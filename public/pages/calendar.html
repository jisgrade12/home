<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/x-icon" href="../images/12_l.png" />
		<link rel="stylesheet" href="../stylesheets/style.css" />
		<link
			rel="stylesheet"
			href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
		/>
		<link
			rel="stylesheet"
			type="text/css"
			href="https://unpkg.com/js-year-calendar@latest/dist/js-year-calendar.min.css"
		/>
		<title>Grade 12 | Calendar</title>
		<script type="text/javascript">
			window.$crisp = [];
			window.CRISP_WEBSITE_ID = "dabd32ac-0dd3-4b77-9001-dcbe68217c70";
			(function () {
				d = document;
				s = d.createElement("script");
				s.src = "https://client.crisp.chat/l.js";
				s.async = 1;
				d.getElementsByTagName("head")[0].appendChild(s);
			})();
		</script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://unpkg.com/popper.js@1.14.7/dist/umd/popper.min.js"></script>
	</head>
	<body>
		<nav>
			<a href="../index.html"
				><img src="../images/12_s.png" alt="Grade 12 Logo"
			/></a>
			<h1 id="nav-name">Calendar</h1>
			<span class="pages"
				><a href="../index.html"
					><span class="material-symbols-outlined">
						home <span class="hover-info">Home</span></span
					></a
				><a href="members.html"
					><span class="material-symbols-outlined">
						group <span class="hover-info">Members</span></span
					></a
				><a href="documents.html"
					><span class="material-symbols-outlined">
						feed <span class="hover-info">Documents</span></span
					></a
				><a href="timeline.html"
					><span class="material-symbols-outlined">
						view_timeline <span class="hover-info">Timeline</span></span
					></a
				><a href="chat.html"
					><span class="material-symbols-outlined">
						chat <span class="hover-info">Chatting</span></span
					></a
				><a href="#tp" id="activated"
					><span class="material-symbols-outlined">
						calendar_month <span class="hover-info">Calendar</span></span
					></a
				><a href="countdown.html"
					><span class="material-symbols-outlined">
						hourglass_empty <span class="hover-info">Countdown(s)</span></span
					></a
				><a href="suggest.html"
					><span class="material-symbols-outlined">
						assistant <span class="hover-info">Suggestions</span></span
					></a
				><a href="games.html"
					><span class="material-symbols-outlined">
						stadia_controller <span class="hover-info">Games</span></span
					></a
				><a href="signup.html"
					><span class="material-symbols-outlined">
						account_circle <span class="hover-info">Account</span></span
					></a
				></span
			>
		</nav>
		<div class="nav-resistance" id="tp"></div>
		<div data-provide="calendar"></div>
		<script src="https://unpkg.com/js-year-calendar@latest/dist/js-year-calendar.min.js"></script>
		<script>
			import Calendar from "js-year-calendar";
			import "js-year-calendar/dist/js-year-calendar.css";
			new Calendar(".calendar", {
				style: "background",
				minDate: new Date(),
			});
			calendar.setStyle("background");
			calendar.setMaxDate(new Date());
			document
				.querySelector(".calendar")
				.addEventListener("yearChanged", function (e) {
					console.log("New year selected: " + e.currentYear);
				});
		</script>
		<footer>
			&#169;
			<script>
				document.write(/\d{4}/.exec(Date())[0]);
			</script>
			JIS Grade 12 &#124; Made with &#10084; by Arsalan
		</footer>
		<script>
			let calendar = null;

			function editEvent(event) {
				$('#event-modal input[name="event-index"]').val(event ? event.id : "");
				$('#event-modal input[name="event-name"]').val(event ? event.name : "");
				$('#event-modal input[name="event-location"]').val(
					event ? event.location : ""
				);
				$('#event-modal input[name="event-start-date"]').datepicker(
					"update",
					event ? event.startDate : ""
				);
				$('#event-modal input[name="event-end-date"]').datepicker(
					"update",
					event ? event.endDate : ""
				);
				$("#event-modal").modal();
			}

			function deleteEvent(event) {
				var dataSource = calendar.getDataSource();

				calendar.setDataSource(
					dataSource.filter((item) => item.id !== event.id)
				);
			}

			function saveEvent() {
				var event = {
					id: $('#event-modal input[name="event-index"]').val(),
					name: $('#event-modal input[name="event-name"]').val(),
					location: $('#event-modal input[name="event-location"]').val(),
					startDate: $(
						'#event-modal input[name="event-start-date"]'
					).datepicker("getDate"),
					endDate: $('#event-modal input[name="event-end-date"]').datepicker(
						"getDate"
					),
				};

				var dataSource = calendar.getDataSource();

				if (event.id) {
					for (var i in dataSource) {
						if (dataSource[i].id == event.id) {
							dataSource[i].name = event.name;
							dataSource[i].location = event.location;
							dataSource[i].startDate = event.startDate;
							dataSource[i].endDate = event.endDate;
						}
					}
				} else {
					var newId = 0;
					for (var i in dataSource) {
						if (dataSource[i].id > newId) {
							newId = dataSource[i].id;
						}
					}

					newId++;
					event.id = newId;

					dataSource.push(event);
				}

				calendar.setDataSource(dataSource);
				$("#event-modal").modal("hide");
			}

			$(function () {
				var currentYear = new Date().getFullYear();

				calendar = new Calendar("#calendar", {
					enableContextMenu: true,
					enableRangeSelection: true,
					contextMenuItems: [
						{
							text: "Update",
							click: editEvent,
						},
						{
							text: "Delete",
							click: deleteEvent,
						},
					],
					selectRange: function (e) {
						editEvent({ startDate: e.startDate, endDate: e.endDate });
					},
					mouseOnDay: function (e) {
						if (e.events.length > 0) {
							var content = "";

							for (var i in e.events) {
								content +=
									'<div class="event-tooltip-content">' +
									'<div class="event-name" style="color:' +
									e.events[i].color +
									'">' +
									e.events[i].name +
									"</div>" +
									'<div class="event-location">' +
									e.events[i].location +
									"</div>" +
									"</div>";
							}

							$(e.element).popover({
								trigger: "manual",
								container: "body",
								html: true,
								content: content,
							});

							$(e.element).popover("show");
						}
					},
					mouseOutDay: function (e) {
						if (e.events.length > 0) {
							$(e.element).popover("hide");
						}
					},
					dayContextMenu: function (e) {
						$(e.element).popover("hide");
					},
					dataSource: [
						{
							id: 0,
							name: "Google I/O",
							location: "San Francisco, CA",
							startDate: new Date(currentYear, 4, 28),
							endDate: new Date(currentYear, 4, 29),
						},
						{
							id: 1,
							name: "Microsoft Convergence",
							location: "New Orleans, LA",
							startDate: new Date(currentYear, 2, 16),
							endDate: new Date(currentYear, 2, 19),
						},
						{
							id: 2,
							name: "Microsoft Build Developer Conference",
							location: "San Francisco, CA",
							startDate: new Date(currentYear, 3, 29),
							endDate: new Date(currentYear, 4, 1),
						},
						{
							id: 3,
							name: "Apple Special Event",
							location: "San Francisco, CA",
							startDate: new Date(currentYear, 8, 1),
							endDate: new Date(currentYear, 8, 1),
						},
						{
							id: 4,
							name: "Apple Keynote",
							location: "San Francisco, CA",
							startDate: new Date(currentYear, 8, 9),
							endDate: new Date(currentYear, 8, 9),
						},
						{
							id: 5,
							name: "Chrome Developer Summit",
							location: "Mountain View, CA",
							startDate: new Date(currentYear, 10, 17),
							endDate: new Date(currentYear, 10, 18),
						},
						{
							id: 6,
							name: "F8 2015",
							location: "San Francisco, CA",
							startDate: new Date(currentYear, 2, 25),
							endDate: new Date(currentYear, 2, 26),
						},
						{
							id: 7,
							name: "Yahoo Mobile Developer Conference",
							location: "New York",
							startDate: new Date(currentYear, 7, 25),
							endDate: new Date(currentYear, 7, 26),
						},
						{
							id: 8,
							name: "Android Developer Conference",
							location: "Santa Clara, CA",
							startDate: new Date(currentYear, 11, 1),
							endDate: new Date(currentYear, 11, 4),
						},
						{
							id: 9,
							name: "LA Tech Summit",
							location: "Los Angeles, CA",
							startDate: new Date(currentYear, 10, 17),
							endDate: new Date(currentYear, 10, 17),
						},
					],
				});

				$("#save-event").click(function () {
					saveEvent();
				});
			});
		</script>
	</body>
</html>
